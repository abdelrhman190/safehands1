<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø¬Ù„ÙŠØ³Ø© Ø§Ù„Ø£Ø·ÙØ§Ù„</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="/style.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Montserrat', sans-serif;
}

body {
    background: linear-gradient(to right, #fff0f3, #f4e4f0, #e6f7f6);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

header {
    background: linear-gradient(135deg, #fcdcec, #ffb6c1);
    padding: 15px 0;
    position: fixed;
    width: 100%;
    top: 0;
    z-index: 1000;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    transition: background 0.5s ease-in-out;
}

nav {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
    position: relative;
}

.logo {
    font-size: 24px;
    font-weight: 600;
    color: #000;
    display: flex;
    align-items: center;
    gap: 5px;
}

.logo img {
    width: 35px;
    height: 35px;
}

.language-selector select {
    padding: 10px;
    border-radius: 5px;
    border: none;
    font-size: 1rem;
    cursor: pointer;
}

nav ul {
    list-style: none;
    display: flex;
    gap: 20px;
    align-items: center;
}

nav ul li a {
    color: #4a4a4a;
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    transition: color 0.3s ease;
}

nav ul li a:hover {
    color: #ff6b81;
}

.hamburger {
    display: none;
    font-size: 28px;
    color: #ff6b81;
    cursor: pointer;
    padding: 10px;
}

.menu-toggle input[type="checkbox"] {
    display: none;
}

.user-profile-capsule {
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.9);
    padding: 5px 14px 5px 7px;
    border-radius: 50px;
    border: 1px solid #ffb6c1;
    text-decoration: none;
    transition: all 0.3s ease;
    gap: 10px;
}

.user-profile-capsule:hover {
    background: #fff;
    box-shadow: 0 5px 12px rgba(255, 107, 129, 0.25);
    transform: translateY(-2px);
}

.user-avatar-container {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    overflow: hidden;
    border: 2.5px solid #ff6b81;
}

.user-avatar-container img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

#user-name-text {
    font-size: 14.5px;
    font-weight: 600;
    color: #333;
}

#logout-link {
    background-color: #fff0f5;
    color: #ff6b81 !important;
    padding: 7px 16px;
    border-radius: 30px;
    font-weight: 600;
    font-size: 13.5px;
    text-decoration: none;
    border: 1.5px dashed #ffb6c1;
    transition: all 0.3s ease;
}

#logout-link:hover {
    background-color: #ff6b81;
    color: white !important;
    border-style: solid;
    transform: scale(1.05);
}

.profile-section {
    padding: 100px 20px 40px;
    flex: 1;
}

.profile-container {
    max-width: 800px;
    margin: 0 auto;
    background: linear-gradient(135deg, #fff, #ffccd5);
    padding: 30px;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.05);
    text-align: center;
}

.profile-header {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
}

.profile-container img {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid #ffccd5;
    transition: transform 0.3s ease;
}

.profile-container img:hover {
    transform: scale(1.1);
}

.profile-container h2 {
    font-size: 28px;
    color: #2c3e50;
    margin: 0;
}

.status-badge {
    display: inline-block;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 16px;
    font-weight: 600;
}

.status-badge.busy-today {
    background: #ff6b81;
    color: #fff;
}

.status-badge.available-today {
    background: #98ded9;
    color: #2c3e50;
}

.profile-info {
    margin-top: 20px;
    display: grid;
    grid-template-columns: 1fr;
    gap: 12px;
    text-align: right;
}

.profile-info p {
    font-size: 16px;
    color: #555;
    display: flex;
    align-items: center;
    gap: 8px;
}

.profile-info i {
    color: #ff8a9b;
}

.booked-dates {
    margin-top: 20px;
    text-align: right;
}

.booked-dates h4 {
    font-size: 18px;
    color: #2c3e50;
    margin-bottom: 10px;
}

.booked-dates ul {
    list-style: none;
    padding: 0;
}

.booked-dates li {
    background: #f9f9f9;
    padding: 8px 12px;
    border-radius: 8px;
    margin-bottom: 8px;
    font-size: 14px;
    color: #555;
}

.contact-btn {
    display: inline-block;
    margin-top: 20px;
    background: linear-gradient(135deg, #ffccd5, #ff8a9b);
    color: #2c3e50;
    padding: 12px 24px;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
}

.contact-btn:hover {
    background: linear-gradient(135deg, #ff8a9b, #98ded9);
    transform: translateY(-2px);
}

.login-prompt {
    color: #ff6b81;
    font-size: 16px;
    margin-top: 20px;
}

.footer {
    background: linear-gradient(135deg, #fcdcec, #ffccd5);
    color: #000;
    padding: 40px 20px;
}

.footer .container {
    max-width: 1200px;
    margin: 0 auto;
}

.footer .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.footer h3 {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 15px;
}

.footer p, .footer ul li {
    font-size: 14px;
    line-height: 1.6;
}

.footer ul {
    list-style: none;
    padding: 0;
}

.footer ul li a {
    color: #000;
    text-decoration: none;
    transition: color 0.3s ease;
}

.footer ul li a:hover {
    color: #98ded9;
}

.Social-Media {
    display: flex;
    justify-content: center;
    gap: 15px;
}

.Social-Media a {
    display: flex;
    background: #e3edf7;
    height: 40px;
    width: 40px;
    border-radius: 8px;
    align-items: center;
    justify-content: center;
    text-decoration: none;
    box-shadow: 3px 3px 5px -0.5px rgba(0, 0, 0, 0.15), -3px -3px 5px -0.5px rgba(255, 255, 255, 0.7);
    transition: transform 0.5s;
}

.Social-Media a i {
    font-size: 20px;
    color: #777;
    transition: transform 0.5s;
}

.Social-Media a:hover {
    box-shadow: inset 4px 4px 6px -1px rgba(0, 0, 0, 0.2), inset -4px -4px 6px -1px rgba(255, 255, 255, 0.7), -0.5px -0.5px 0px rgba(255, 255, 255, 1), 0.5px 0.5px 0px rgba(0, 0, 0, 0.15), 0px 12px 10px -10px rgba(0, 0, 0, 0.05);
    transform: translateY(2px);
}

.Social-Media a:hover i {
    transform: scale(0.90);
}

.Social-Media a:hover .fa-facebook { color: #3b5998; }
.Social-Media a:hover .fa-whatsapp { color: #4fce5d; }
.Social-Media a:hover .fa-twitter { color: #00acee; }
.Social-Media a:hover .fa-instagram { color: #f14843; }
.Social-Media a:hover .fa-linkedin { color: #3b5998; }
.Social-Media a:hover .fa-youtube { color: #f00; }

.footer .copyright {
    text-align: center;
    font-size: 14px;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
}

@media (max-width: 768px) {
    nav ul {
        display: none;
        position: absolute;
        top: 100%;
        right: 0;
        width: 200px;
        background: linear-gradient(135deg, #ffccd5, #e6f7f6);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    nav .menu-toggle label {
        display: block;
    }

    nav .menu-toggle input[type="checkbox"]:checked ~ ul {
        display: block;
    }

    nav ul li {
        margin: 10px 0;
    }

    nav ul li a {
        display: block;
        padding: 10px;
    }

    .profile-section {
        padding: 80px 15px 30px;
    }

    .profile-container {
        padding: 20px;
    }

    .profile-container img {
        width: 120px;
        height: 120px;
    }

    .profile-container h2 {
        font-size: 24px;
    }

    .status-badge {
        font-size: 14px;
        padding: 6px 12px;
    }

    .profile-info p {
        font-size: 14px;
    }

    .booked-dates h4 {
        font-size: 16px;
    }

    .booked-dates li {
        font-size: 12px;
    }

    .contact-btn {
        padding: 10px 20px;
        font-size: 14px;
    }

    .footer .grid {
        grid-template-columns: 1fr;
        text-align: center;
    }

    .Social-Media {
        justify-content: center;
    }
}

@media (max-width: 480px) {
    header {
        padding: 8px 0;
    }

    nav {
        padding: 0 10px;
    }

    .logo {
        font-size: 18px;
    }

    .logo img {
        width: 25px;
        height: 25px;
    }

    .language-selector select {
        padding: 6px;
        font-size: 0.8rem;
    }

    nav ul {
        width: 100%;
        padding: 10px;
    }

    nav ul li a {
        font-size: 14px;
    }

    .profile-container img {
        width: 100px;
        height: 100px;
    }

    .profile-container h2 {
        font-size: 20px;
    }

    .status-badge {
        font-size: 12px;
        padding: 5px 10px;
    }

    .profile-info p {
        font-size: 12px;
    }

    .booked-dates h4 {
        font-size: 14px;
    }

    .contact-btn {
        padding: 8px 16px;
        font-size: 12px;
    }

    .footer {
        padding: 20px 10px;
    }

    .footer h3 {
        font-size: 16px;
    }

    .footer p, .footer ul li {
        font-size: 12px;
    }

    .footer .copyright {
        font-size: 10px;
    }

    .Social-Media a {
        height: 30px;
        width: 30px;
    }

    .Social-Media a i {
        font-size: 14px;
    }
}
#logout-item {
    margin-left: auto; /* ÙŠØ¯ÙØ¹ Ø§Ù„Ø²Ø±Ø§Ø± Ù„Ù„ÙŠÙ…ÙŠÙ† Ù„Ùˆ Ø¹Ø§ÙŠØ² */
}

#logout-link {
    display: inline-flex !important;
    align-items: center;
    justify-content: center;
    background: linear-gradient(135deg, #ffccd5 0%, #ff8a9b 100%);
    color: #ffffff !important;
    padding: 10px 24px;
    border-radius: 999px; /* ÙƒØ¨Ø³ÙˆÙ„Ø© ÙƒØ§Ù…Ù„Ø© Ù†Ø§Ø¹Ù…Ø© */
    font-weight: 700;
    font-size: 14px;
    text-decoration: none;
    box-shadow: 0 4px 14px rgba(255, 107, 129, 0.35);
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    min-width: 145px;
    border: none;
    letter-spacing: 0.5px;
    text-transform: uppercase;
}

#logout-link:hover {
    background: linear-gradient(135deg, #ff8a9b 0%, #ff6b81 100%);
    transform: translateY(-3px) scale(1.04);
    box-shadow: 0 10px 25px rgba(255, 107, 129, 0.5);
    color: #ffffff !important;
}

/* Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙŠØµØºØ± Ø´ÙˆÙŠØ© */
@media (max-width: 768px) {
    #logout-link {
        padding: 9px 20px;
        font-size: 13.5px;
        min-width: 130px;
    }
}
  </style>
</head>
<body>
  <header>
    <nav>
    <div id="logo" class="logo">
      <img src="../images-1-removebg-preview.png" alt="Safe Hands Icon">
      <span data-i18n="site_title">Safe Hands</span>
    </div>

    <div class="language-selector">
      <select id="languageSelect" onchange="changeLanguage()">
        <option value="ar">ğŸ‡ªğŸ‡¬ Ø¹Ø±Ø¨ÙŠ</option>
        <option value="en">ğŸ‡ºğŸ‡¸ English</option>
      </select>
    </div>

    <div class="menu-toggle">
      <input type="checkbox" id="menu-toggle">
      <label for="menu-toggle" class="hamburger">â˜°</label>

      <ul>
        <li><a href="../index.html" class="nav-link" data-i18n="nav_home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
        <li><a href="index.html" class="nav-link" data-i18n="nav_services">Ø§Ù„Ø®Ø¯Ù…Ø§Øª</a></li>
        <li><a href="../about/index.html" class="nav-link" data-i18n="nav_about">Ù…Ù† Ù†Ø­Ù†</a></li>
        <li><a href="../con/index.html" class="nav-link" data-i18n="nav_contact">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a></li>
        <li><a href="/baby/index.html" class="nav-link" data-i18n="nav_find_babysitters">Ø§Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù„ÙŠØ³Ø§Øª Ø£Ø·ÙØ§Ù„</a></li>
<!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù„Ù„Ø²ÙˆØ§Ø±) -->
<li id="login-item">
    <a href="../log/login.html" id="login-link" class="nav-link" data-i18n="nav_login_signup">
        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ / Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨
    </a>
</li>

<!-- ÙƒØ¨Ø³ÙˆÙ„Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ (Ù„Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†) -->
<li id="user-name-display" style="display: none;">
    <a href="/my_pro/profile.html" class="user-profile-capsule">
        <div class="user-avatar-container">
            <img id="user-avatar-img" src="/img/default-avatar.png" alt="User">
        </div>
        <span id="user-name-text"></span>
    </a>
</li>

<!-- Ø²Ø±Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ â€“ Ø§Ù„Ù€ ID Ø§Ù„Ù…Ù‡Ù… Ù‡Ù†Ø§ Ù‡Ùˆ logout-item -->
<li id="logout-item" style="display: none;">
    <a href="#" id="logout-link" onclick="logout(); return false;" data-i18n="nav_logout">
        ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
    </a>
</li>
      </ul>
    </div>
  </nav>
  </header>

  <main class="profile-section">
    <div class="profile-container" id="profile"></div>
  </main>

  <footer class="footer">
    <div class="container">
      <div class="grid">
        <div>
          <h3 data-i18n="footer_company_title">Safe Hands</h3>
          <p data-i18n="footer_company_description">Ø§Ø­Ø¬Ø² Ø¬Ù„ÙŠØ³Ø§Øª Ø£Ø·ÙØ§Ù„ Ù…ÙˆØ«ÙˆÙ‚Ø© ÙˆÙ…ÙØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø© ÙˆØ«Ù‚Ø©.</p>
        </div>
        <div>
          <h3 data-i18n="footer_links_title">Ø§Ù„Ø±ÙˆØ§Ø¨Ø·</h3>
          <ul>
            <li><a href="/index.html" data-i18n="nav_home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
            <li><a href="/about/index.html" data-i18n="nav_about">Ù…Ù† Ù†Ø­Ù†</a></li>
            <li><a href="/services/index.html" data-i18n="nav_services">Ø§Ù„Ø®Ø¯Ù…Ø§Øª</a></li>
            <li><a href="/con/index.html" data-i18n="nav_contact">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a></li>
          </ul>
        </div>
        <div>
          <h3 data-i18n="footer_contact_title">ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
          <ul>
            <li data-i18n="footer_contact_email">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: Safehands.com</li>
            <li data-i18n="footer_contact_phone">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: 01279581077</li>
            <li data-i18n="footer_contact_address">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: 202 Ø´Ø§Ø±Ø¹ Ø¨Ø§ÙƒÙˆØ³ØŒ Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©ØŒ Ù…ØµØ±</li>
          </ul>
        </div>
        <div class="Social-Media">
          <a href="#"><i class="fab fa-facebook"></i></a>
          <a href="#"><i class="fab fa-whatsapp"></i></a>
          <a href="#"><i class="fab fa-instagram"></i></a>
          <a href="#"><i class="fab fa-twitter"></i></a>
          <a href="#"><i class="fab fa-linkedin"></i></a>
          <a href="#"><i class="fab fa-youtube"></i></a>
        </div>
      </div>
      <div class="copyright">
        <span data-i18n="footer_copyright">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©. 2025 Safe Hands.</span>
      </div>
    </div>
  </footer>

  <script>
    // 1. Ø¥Ø¹Ø¯Ø§Ø¯ Supabase
const SUPABASE_URL = "https://ebzhfytrzcxsnepcudyl.supabase.co"; 
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImViemhmeXRyemN4c25lcGN1ZHlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDYyMDMyNjcsImV4cCI6MjA2MTc3OTI2N30.8sJgkbHRYMddNadF9aPgeLmNRuo7XOa3iyrXjHkumTc"; 
const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

// ==================== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‡ÙŠØ¯Ø± (Navbar) ====================

// ØªÙ… ØªØºÙŠÙŠØ± Ø§Ù„Ø§Ø³Ù… Ù„ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ø§Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡Ø§Øª
function updateNavbar() {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    const isLoggedIn = !!(userData.contact_info || userData.email || userData.id);

    // Ø¬Ù„Ø¨ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø¨Ø£Ù…Ø§Ù† (Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯Ø© â†’ null)
    const loginItem     = document.getElementById('login-item') || document.getElementById('login-signup-link');
    const logoutItem    = document.getElementById('logout-item');
    const userDisplay   = document.getElementById('user-name-display');
    const userName      = document.getElementById('user-name-text');
    const userAvatar    = document.getElementById('user-avatar-img');

    if (isLoggedIn) {
        // Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ â†’ Ø¥Ø®ÙØ§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙƒØ¨Ø³ÙˆÙ„Ø© + Ø§Ù„Ø®Ø±ÙˆØ¬
        if (loginItem)      loginItem.style.display = 'none';
        if (logoutItem)     logoutItem.style.display = 'block';
        if (userDisplay)    userDisplay.style.display = 'inline-flex'; // Ø£Ùˆ 'flex' Ù„Ùˆ Ø¹Ø§ÙŠØ²
        if (userName)       userName.textContent = userData.name || 'Ù…Ø³ØªØ®Ø¯Ù…';
        if (userAvatar) {
            userAvatar.src = userData.image_url || userData.profile_pic || '/img/default-avatar.png';
            userAvatar.alt = userData.name || 'ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
        }
    } else {
        // Ø²Ø§Ø¦Ø± â†’ Ø¥Ø¸Ù‡Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨Ø§Ù‚ÙŠ
        if (loginItem)      loginItem.style.display = 'block';
        if (logoutItem)     logoutItem.style.display = 'none';
        if (userDisplay)    userDisplay.style.display = 'none';
        if (userAvatar)     userAvatar.src = '/img/default-avatar.png';
    }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ø¶Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù€ avatar + Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø®Ø·Ø£ (ÙŠØ´ØªØºÙ„ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©)
function setupAvatarFallback() {
    const avatarImg = document.getElementById('user-avatar-img');
    if (!avatarImg) return;

    // Ø¶Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù…Ù† localStorage (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„)
    const user = JSON.parse(localStorage.getItem('userData') || '{}');
    if (user && (user.image_url || user.profile_pic)) {
        avatarImg.src = user.image_url || user.profile_pic;
    } else {
        avatarImg.src = "/img/default-avatar.png";
    }

    // fallback Ù„Ùˆ Ø§Ù„ØµÙˆØ±Ø© Ù…Ø§ Ø§ØªØ­Ù…Ù„ØªØ´ (404 Ø£Ùˆ Ø®Ø·Ø£ Ø´Ø¨ÙƒØ©)
    avatarImg.onerror = () => {
        avatarImg.src = "/img/default-avatar.png";
        avatarImg.onerror = null; // Ù†Ù…Ù†Ø¹ loop Ù„Ø§ Ù†Ù‡Ø§Ø¦ÙŠ
    };
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ÙˆØ§Ø­Ø¯ Ù…Ø±ÙƒØ²ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', () => {
    // 1. ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± ÙÙˆØ±Ø§Ù‹
    updateNavbar();

    // 2. Ø¶Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù€ avatar + Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    setupAvatarFallback();

    // 3. (Ø§Ø®ØªÙŠØ§Ø±ÙŠ) Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†Ø§ÙØ¨Ø§Ø± ÙƒÙ„ Ù…Ø§ ÙŠØªØºÙŠØ± localStorage
    // Ù…ÙÙŠØ¯ Ù„Ùˆ ÙÙŠÙ‡ ØªØ¨ÙˆÙŠØ¨Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
    window.addEventListener('storage', (e) => {
        if (e.key === 'userData') {
            updateNavbar();
            setupAvatarFallback();
        }
    });
});
function logout() {
    localStorage.removeItem('userData'); 
    updateNavbar(); 
    window.location.href = '/log/login.html'; 
}

// ==================== ØªØ­Ù…ÙŠÙ„ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ø§Ù„Ø¬Ù„ÙŠØ³Ø© ====================
async function loadProfile() {
    const params = new URLSearchParams(window.location.search);
    const babysitterId = params.get("id");
    const profileContainer = document.getElementById("profile");

    if (!babysitterId) {
        profileContainer.innerHTML = "<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø±ÙˆÙØ§ÙŠÙ„ Ù…Ø­Ø¯Ø¯.</p>";
        return;
    }

    try {
        // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„ÙŠØ³Ø©
        const { data: sitter, error } = await supabaseClient
            .from("babysitters")
            .select("*")
            .eq("id", babysitterId)
            .single();

        if (error || !sitter) throw error;

        // Ø¬Ù„Ø¨ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª
        const { data: bookings } = await supabaseClient
            .from("bookings")
            .select("booking_date")
            .eq("babysitter_id", babysitterId);

        const today = new Date().toISOString().split("T")[0];
        const busyToday = bookings?.some(b => b.booking_date === today);
        
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ© ÙÙ‚Ø·
        const futureBookings = bookings
            ?.map(b => b.booking_date)
            .filter(date => date >= today)
            .sort();

        const userLoggedIn = !!localStorage.getItem('userData');

        // Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø±ÙˆÙØ§ÙŠÙ„
        profileContainer.innerHTML = `
            <img src="${sitter.profile_image || 'https://via.placeholder.com/150'}" alt="${sitter.name}">
            <h2>${sitter.name}</h2>
            <p class="status-badge ${busyToday ? 'busy-today' : 'available-today'}">
                ${busyToday ? 'ğŸ”´ Ù…Ø´ØºÙˆÙ„Ø© Ø§Ù„ÙŠÙˆÙ…' : 'ğŸŸ¢ Ù…ØªØ§Ø­Ø© Ø§Ù„ÙŠÙˆÙ…'}
            </p>
            <div class="profile-info">
                <p><i class="fas fa-graduation-cap"></i> Ø§Ù„Ø®Ø¨Ø±Ø©: ${sitter.experience || 0} Ø³Ù†ÙˆØ§Øª</p>
                <p><i class="fas fa-star"></i> Ø§Ù„ØªÙ‚ÙŠÙŠÙ…: ${sitter.rating || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨Ø¹Ø¯'}</p>
                <p><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø³Ø§Ø¹Ø©: ${sitter.hourly_rate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'} Ø¬.Ù…</p>
                <p><i class="fas fa-heart"></i> Ø§Ù„ØªØ®ØµØµØ§Øª: ${sitter.specialties || 'Ù„Ø§ ØªÙˆØ¬Ø¯'}</p>
            </div>
            <div class="booked-dates">
                <h4>Ø§Ù„ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø­Ø¬ÙˆØ²Ø© Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹:</h4>
                <ul>
                    ${futureBookings && futureBookings.length > 0 
                        ? futureBookings.map(date => `<li>${date}</li>`).join('') 
                        : '<li>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø¬ÙˆØ²Ø§Øª Ø­Ø§Ù„ÙŠØ©</li>'}
                </ul>
            </div>
            ${userLoggedIn 
                ? `<a href="/booking/book.html?babysitter_id=${sitter.id}" class="contact-btn"><i class="fas fa-calendar-plus"></i> Ø§Ø­Ø¬Ø² Ø§Ù„Ø¢Ù†</a>` 
                : '<p class="login-prompt">ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„ØªØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­Ø¬Ø²</p>'}
        `;
    } catch (err) {
        console.error("Error:", err);
        profileContainer.innerHTML = "<p>Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù„ÙŠØ³Ø©.</p>";
    }
}

// ==================== Ø§Ù„ØªØ´ØºÙŠÙ„ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© ====================
document.addEventListener('DOMContentLoaded', () => {
    updateNavbar(); // ØªÙ… ØªÙˆØ­ÙŠØ¯ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§
    loadProfile();
});
  </script>
</body>
</html>